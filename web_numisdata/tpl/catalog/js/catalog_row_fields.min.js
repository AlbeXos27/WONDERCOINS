"use strict";var catalog_row_fields={ar_rows:[],caller:null,draw_item:function(item){const self=this,term_table=item.term_table,fragment=new DocumentFragment;function load_hires(){this.removeEventListener("load",load_hires,!1);const image=this,hires=this.hires;setTimeout((function(){image.src=hires}),1600)}switch(term_table){case"types":if(item.children&&item.children.length>0){const term_line=common.create_dom_element({element_type:"div",class_name:"term_line",parent:fragment});self.node_factory(item,"term",term_line,"span",null),self.node_factory(item,"ref_type_material",term_line,null,null),self.node_factory(item,"ref_type_denomination",term_line,null,null),self.node_factory(item,"ref_type_averages_weight",term_line,null,null),self.node_factory(item,"ref_type_total_weight_items",term_line,null,null),self.node_factory(item,"ref_type_averages_diameter",term_line,null,null),self.node_factory(item,"ref_type_total_diameter_items",term_line,null,null)}else{const type_container=common.create_dom_element({element_type:"div",class_name:"type_container",parent:fragment}),type_info=common.create_dom_element({element_type:"div",class_name:"type_info",parent:type_container});self.node_factory(item,"term",type_info,"span",null);const my_parent=item.parent?item.parent[0]:null,add_denomination=item.add_denomination?item.add_denomination:null,parent_element=self.ar_rows.find(el=>el.section_id==my_parent);(add_denomination||parent_element&&"types"!==parent_element.term_table)&&(self.node_factory(item,"ref_type_material",type_info,null,null),self.node_factory(item,"ref_type_denomination",type_info,null,null)),self.node_factory(item,"ref_type_averages_weight",type_info,null,null),self.node_factory(item,"ref_type_total_weight_items",type_info,null,null),self.node_factory(item,"ref_type_averages_diameter",type_info,null,null),self.node_factory(item,"ref_type_total_diameter_items",type_info,null,null);const descriptions=common.create_dom_element({element_type:"div",class_name:"descriptions",parent:type_info});self.node_factory(item,"ref_type_design_obverse",descriptions,null,null),self.node_factory(item,"ref_type_symbol_obverse",descriptions,null,null);const legend_obverse=common.create_dom_element({element_type:"div",class_name:"legend_obverse",parent:descriptions});item.ref_type_legend_obverse&&legend_obverse.appendChild(page.render_legend({value:item.ref_type_legend_obverse,style:"small legend_obverse_box"})),self.node_factory(item,"ref_type_legend_transcription_obverse",legend_obverse,null,null),self.node_factory(item,"ref_type_design_reverse",descriptions,null,null),self.node_factory(item,"ref_type_symbol_reverse",descriptions,null,null);const legend_reverse=common.create_dom_element({element_type:"div",class_name:"legend_reverse",parent:descriptions});item.ref_type_legend_reverse&&legend_reverse.appendChild(page.render_legend({value:item.ref_type_legend_reverse,style:"small legend_obverse_box"})),self.node_factory(item,"ref_type_legend_transcription_reverse",legend_reverse,null,null),self.node_factory(item,"ref_type_equivalents",type_container,null,null);const mint_number=item.ref_mint_number?item.ref_mint_number+"/":"",ar=item.term.split(", "),c_name=ar[0],diameter=item.ref_type_averages_diameter?Math.round(item.ref_type_averages_diameter,0):15,coins_images_container=common.create_dom_element({element_type:"div",class_name:"coins_images_container",parent:type_container}),coins_images=common.create_dom_element({element_type:"div",class_name:"coins_images",parent:coins_images_container});coins_images.style.width=4*diameter+"mm";let image_obverse=item.ref_coins_image_obverse_thumb.replace(".jpg",".png"),image_reverse=item.ref_coins_image_reverse_thumb.replace(".jpg",".png");catalog_row_fields.cargarImagen(item.term_section_id).then((function(imageObverse){if(imageObverse&&"/dedalo/media/image/1.5MB/20000/rsc29_rsc170_20917.jpg"!==imageObverse.image_obverse&&null!=imageObverse.image_obverse){const image_link_obverse=common.create_dom_element({element_type:"a",class_name:"image_link",href:"https://wondercoins.uca.es"+imageObverse.image_obverse,parent:coins_images}),img_obverse=common.create_dom_element({element_type:"img",class_name:"image_obverse",src:"https://wondercoins.uca.es"+imageObverse.image_obverse,title:item.section_id,dataset:{caption:page_globals.OWN_CATALOG_ACRONYM+" "+mint_number+c_name},parent:image_link_obverse});img_obverse.style.width=2*diameter+"mm",img_obverse.hires="https://wondercoins.uca.es"+imageObverse.image_obverse,img_obverse.loading="lazy",img_obverse.addEventListener("load",load_hires,!1);const image_link_reverse=common.create_dom_element({element_type:"a",class_name:"image_link",href:"https://wondercoins.uca.es"+imageObverse.image_reverse,parent:coins_images}),img_reverse=common.create_dom_element({element_type:"img",class_name:"image_reverse",src:"https://wondercoins.uca.es"+imageObverse.image_reverse,title:item.section_id,parent:image_link_reverse});img_reverse.style.width=2*diameter+"mm",img_reverse.hires="https://wondercoins.uca.es"+imageObverse.image_reverse,img_reverse.loading="lazy",img_reverse.addEventListener("load",load_hires,!1)}else{const image_link_obverse=common.create_dom_element({element_type:"a",class_name:"image_link",href:image_obverse,parent:coins_images}),img_obverse=common.create_dom_element({element_type:"img",class_name:"image_obverse",src:image_obverse,title:item.section_id,dataset:{caption:page_globals.OWN_CATALOG_ACRONYM+" "+mint_number+c_name},parent:image_link_obverse});img_obverse.style.width="50mm",img_obverse.hires=image_obverse,img_obverse.loading="lazy",img_obverse.addEventListener("load",load_hires,!1);const image_link_reverse=common.create_dom_element({element_type:"a",class_name:"image_link",href:image_reverse,parent:coins_images}),img_reverse=common.create_dom_element({element_type:"img",class_name:"image_reverse",src:image_reverse,title:item.section_id,parent:image_link_reverse});img_reverse.style.width="50mm",img_reverse.hires=image_reverse,img_reverse.loading="lazy",img_reverse.addEventListener("load",load_hires,!1)}})),window.matchMedia&&window.matchMedia("print").addListener((function(mql){mql.matches&&(coins_images.style.width=2*diameter+"mm",img_obverse.style.width=1*diameter+"mm",img_reverse.style.width=1*diameter+"mm"),mql.matches||(coins_images.style.width=4*diameter+"mm",img_obverse.style.width=2*diameter+"mm",img_reverse.style.width=2*diameter+"mm")}));const collection_auction=common.create_dom_element({element_type:"div",class_name:"collection_auction",parent:type_container});self.node_factory(item,"ref_coins_collection",collection_auction,null,null),self.node_factory(item,"ref_coins_auction",collection_auction,null,null)}break;case"mints":if(common.create_dom_element({element_type:"div",class_name:"mint",text_content:null!=item.p_creator?"("+item.p_creator+")":""+item.term,parent:fragment}),item.term_section_id){const link=common.create_dom_element({element_type:"a",class_name:"link link_mint",href:page_globals.__WEB_ROOT_WEB__+"/mint/"+item.term_section_id,target:"_blank",parent:fragment})}break;default:common.create_dom_element({element_type:"div",class_name:term_table+"_value",text_content:item.term,parent:fragment})}const node=common.create_dom_element({element_type:"div",class_name:"row_node "+term_table});return node.appendChild(fragment),node},node_factory:function(item,name,parent,nodetype,class_name){if(item[name]){const current_node_type=nodetype||"span",current_class_name=class_name||name;let current_value;switch(name){case"ref_type_total_weight_items":case"ref_type_total_diameter_items":current_value="("+item[name]+")";break;case"ref_type_averages_weight":current_value=page.render_weight_value(item);break;case"ref_type_averages_diameter":current_value=page.render_diameter_value(item);break;case"ref_type_equivalents":current_value=item[name].replace(/ \| /g," "),current_value=current_value.replace(/<br>/g," | ");break;case"term":current_value=page.render_type_label(item);break;default:current_value=item[name]}const node=common.create_dom_element({element_type:current_node_type,class_name:current_class_name,inner_html:current_value,parent:parent});return node.title=item.section_id,!0}return!1},load_type_coins:function(id){const js_promise=data_manager.request({body:{dedalo_get:"records",table:"types",ar_fields:["*"],lang:page_globals.WEB_CURRENT_LANG_CODE,limit:0,count:!1,sql_filter:"section_id="+id,resolve_portals_custom:{bibliography_data:"bibliographic_references",ref_coins_union:"coins",coin_references:"coins","coins.bibliography_data":"bibliographic_references",ref_coins_findspots_data:"findspots","findspots.bibliography_data":"bibliographic_references",ref_coins_hoard_data:"hoards","hoards.bibliography_data":"bibliographic_references",denomination_data:"denomination",material_data:"material",related_types_data:"types",mint_data:"mints"}}});return js_promise},cargarImagen:async function(id){let imageObverse;try{const response=await catalog_row_fields.load_type_coins(id);response.result&&response.result.length>0&&response.result[0].coin_references&&response.result[0].coin_references.length>0&&(imageObverse=response.result[0].coin_references[0],console.log("imageObverse asignada:",imageObverse))}catch(error){console.error("Error al cargar la imagen:",error)}return imageObverse}};