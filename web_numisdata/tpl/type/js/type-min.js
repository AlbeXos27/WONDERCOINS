"use strict";var type={search_options:{},map:null,export_data_container:null,section_id:null,set_up:function(e){const t=this;t.export_data_container=e.export_data_container,t.section_id=e.section_id;const a=page.render_export_data_buttons();t.export_data_container.appendChild(a),t.export_data_container.classList.add("hide");const o=page.create_suggestions_button();return t.export_data_container.appendChild(o),void 0!==t.section_id&&t.get_row_data({section_id:t.section_id}).then((function(e){const a=document.getElementById("row_detail");for(;a.hasChildNodes();)a.removeChild(a.lastChild);const o=e.result.find((e=>"type"===e.id)),r=e.result.find((e=>"catalog"===e.id));if(void 0!==o.result[0]){const i=o.result[0],n=page.parse_catalog_data(r.result)[0]||null;i.catalog=n,page.parse_type_data(i),event_manager.publish("data_request_done",{request_body:null,result:i,export_data_parser:page.export_parse_type_data});t.list_row_builder(i).then((function(o){a.appendChild(o);const r=o.querySelectorAll("a");if(r&&r.length>0){o.querySelector(".identify_coin_wrapper").remove();Object.create(image_gallery).set_up_embedded({galleryNode:r,galleryPrimId:"embedded-gallery-id",containerId:"embedded-gallery",result:e})}const i=o.querySelectorAll(".gallery");if(i)for(let e=0;e<i.length;e++)page.activate_images_gallery(i[e]);t.export_data_container.classList.remove("hide")}))}})),!0},get_row_data:function(e){const t=e.section_id,a=e.lang||page_globals.WEB_CURRENT_LANG_CODE,o=[];o.push({id:"type",options:{dedalo_get:"records",table:"types",ar_fields:["*"],lang:a,sql_filter:"section_id = "+parseInt(t),count:!1,resolve_portals_custom:{bibliography_data:"bibliographic_references",ref_coins_union:"coins",coin_references:"coins","coins.bibliography_data":"bibliographic_references",ref_coins_findspots_data:"findspots","findspots.bibliography_data":"bibliographic_references",ref_coins_hoard_data:"hoards","hoards.bibliography_data":"bibliographic_references",denomination_data:"denomination",material_data:"material",related_types_data:"types",mint_data:"mints"}}});o.push({id:"catalog",options:{dedalo_get:"records",table:"catalog",ar_fields:["section_id","term","term_data","term_table","term_section_tipo","parents","ref_mint_number","full_coins_reference_calculable","full_coins_reference_diameter_max","full_coins_reference_weight","full_coins_reference_axis"],lang:a,count:!1,sql_filter:"term_data='[\""+parseInt(t)+"\"]' AND term_table='types'",resolve_portals_custom:{parents:"catalog"}}});return data_manager.request({body:{dedalo_get:"combi",ar_calls:o}})},list_row_builder:function(e){const t=this;return new Promise((function(a){t.parse_publication(e.bibliography_data);const o=e.ref_coins_union.length;for(let a=0;a<o;a++){const o=e.ref_coins_union[a];t.parse_publication(o.bibliography_data)}const r=e.ref_coins_findspots_data.length;for(let a=0;a<r;a++){const o=e.ref_coins_findspots_data[a];t.parse_publication(o.bibliography_data)}const i=e.ref_coins_hoard_data.length;for(let a=0;a<i;a++){const o=e.ref_coins_hoard_data[a];t.parse_publication(o.bibliography_data)}t.parse_ordered_coins(e),type_row_fields_min.type_row_fields.caller=t;a(type_row_fields_min.type_row_fields.draw_item(e))}))},parse_publication:function(e){return page.parse_publication(e)},parse_ordered_coins:function(e){const t=[],a=" | ",o=page.split_data(e.ref_coins_typology_data,a),r=o.length,i=page.split_data(e.ref_coins_typology,a),n=page.split_data(e.ref_coins,a);for(let e=0;e<r;e++){const a=o[e]?JSON.parse(o[e])[0]:null,r=n[e]?JSON.parse(n[e]):[],_={typology_id:a,typology:i[e]||null,coins:r};t.push(_)}return e._coins_group=t,t}};